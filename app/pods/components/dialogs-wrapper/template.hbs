{{#if dialogsService.newGame}}
  {{#paper-dialog
    fullscreen=true
    onClose=(action 'toggleDialog' 'newGame' target=dialogsService)
    origin=dialogOrigin}}

    {{#paper-toolbar}}
      <div class='md-toolbar-tools'>
        <h2>New Game</h2>
        <span class='flex'></span>
        {{#paper-button iconButton=true onClick=(action 'toggleDialog' 'newGame' target=dialogsService)}}
          {{paper-icon icon="close"}}
        {{/paper-button}}
      </div>
    {{/paper-toolbar}}

    {{#new-game
      currentUser=currentUser
      gameAdded=(action 'toggleDialog' 'newGame' target=dialogsService)
      tagName=''
      as |newGame|}}
      {{#paper-dialog-content}}
        <div style='width: 800px;'>
          {{#if newGame.isScoringGame}}

            <h4>{{newGame.game.team1.player1.displayName}} & {{newGame.game.team1.player2.displayName}}</h4>
            {{paper-input label='Wins' value=newGame.game.team1Wins type="number" onChange=(action (mut newGame.game.team1Wins))}}
            <h4>{{newGame.game.team2.player1.displayName}} & {{newGame.game.team2.player2.displayName}}</h4>
            {{paper-input label='Wins' value=newGame.game.team2Wins type="number" onChange=(action (mut newGame.game.team2Wins))}}

          {{else}}

            <h4>Team 1</h4>
            <div class="d-f">
              <div class="flex-50">
                {{#paper-select
                  placeholder="Player 1"
                  value=newGame.team1Player1
                  itemLabelCallback=newGame.retrievePlayerName
                  onChange=(action (mut newGame.team1Player1))}}
                  {{#each newGame.players as |player|}}
                    {{#paper-option value=player}}
                      {{player.name}}
                    {{/paper-option}}
                  {{/each}}
                {{/paper-select}}
              </div>

              <div class="flex-50">
                {{#paper-select
                  placeholder="Player 2"
                  value=newGame.team1Player2
                  itemLabelCallback=newGame.retrievePlayerName
                  onChange=(action (mut newGame.team1Player2))}}
                  {{#each newGame.players as |player|}}
                    {{#paper-option value=player}}
                      {{player.name}}
                    {{/paper-option}}
                  {{/each}}
                {{/paper-select}}
              </div>
            </div>

            <h4>Team 2</h4>
            <div class="d-f">
              <div class="flex-50">
                {{#paper-select
                  placeholder="Player 1"
                  value=newGame.team2Player1
                  itemLabelCallback=newGame.retrievePlayerName
                  onChange=(action (mut newGame.team2Player1))}}
                  {{#each newGame.players as |player|}}
                    {{#paper-option value=player}}
                      {{player.name}}
                    {{/paper-option}}
                  {{/each}}
                {{/paper-select}}
              </div>
              <div class="flex-50">
                {{#paper-select
                  placeholder="Player 2"
                  value=newGame.team2Player2
                  itemLabelCallback=newGame.retrievePlayerName
                  onChange=(action (mut newGame.team2Player2))}}
                  {{#each newGame.players as |player|}}
                    {{#paper-option value=player}}
                      {{player.name}}
                    {{/paper-option}}
                  {{/each}}
                {{/paper-select}}
              </div>
            </div>

            <h4>Previous Records</h4>
            {{#if newGame.gamesAgainst.isPending}}
              {{paper-progress-circular}}
            {{else}}
              <div class="md-text-items">
                {{#if newGame.gamesAgainst.content.length}}
                  <p>{{newGame.mostRecent.winningTeam.player1.displayName}} & {{newGame.mostRecent.winningTeam.player2.displayName}} won {{newGame.mostRecent.winningTeamWins}} - {{newGame.mostRecent.losingTeamWins}}</p>
                  <small class="pr-16 d-b mb-8 ta-r"><i>{{moment-format newGame.mostRecent.time "MMM. Do, YYYY @ h:mm a"}}</i></small>
                {{else}}
                  {{#if (and newGame.team1Player1 newGame.team1Player2 newGame.team2Player1 newGame.team2Player2)}}
                    <p>New matchup!</p>
                  {{/if}}
                {{/if}}
              </div>
            {{/if}}

          {{/if}}
        </div>
      {{/paper-dialog-content}}

      {{#paper-dialog-actions class="layout-row"}}
        <span class="flex"></span>
        {{#paper-button onClick=(action newGame.cancelGame)}}Cancel{{/paper-button}}
        {{#if newGame.isScoringGame}}
          {{#paper-button raised=true primary=true onClick=(action newGame.saveGame) disabled=newGame.cannotSave}}Save{{/paper-button}}
        {{else}}
          {{#paper-button raised=true primary=true disabled=cannotStart onClick=(action newGame.startGame)}}Start{{/paper-button}}
        {{/if}}
      {{/paper-dialog-actions}}

    {{/new-game}}

  {{/paper-dialog}}
{{/if}}
